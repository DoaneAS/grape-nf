// main script name
manifest.mainScript = 'grape-pipeline.nf'

// Process configuration
process {

    command = {
        cpus = task.cpus
        "${task.process}/${task.tool}${task.profile}"
    }

    profile = '' 

    errorStrategy = { params?.errorStrategy }
    
    tag = { (id ?: species) + "-${task.tool}-${task.version}"}

    container = { "grape/${task.process.toLowerCase()}:${task.tool.toLowerCase()}-${task.version}" }

    $index {
    	container = { "grape/mapping:${task.tool.toLowerCase()}-${task.version}" }
    }

    $t_index {
    	container = { "grape/quantification:${task.tool.toLowerCase()}-${task.version}" }
    }

}

// get tools
includeConfig "run.cfg"

// includes
includeConfig "config/fastaIndex/${fastaIndex}.config"
includeConfig "config/mapping/${mapper}.config"
includeConfig "config/mergeBam/${mergeBam}.config"
includeConfig "config/inferExp/${inferExp}.config"
includeConfig "config/bigwig/${bigwig}.config"
includeConfig "config/contig/${contig}.config"
includeConfig "config/quantification/${quantification}.config"
