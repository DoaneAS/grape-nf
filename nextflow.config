// main script name
manifest.mainScript = 'grape-pipeline.nf'

//Tools configuration
toolchain  = 'goolf-1.4.10-no-OFED'
python     = 'Python-2.7.3'

mapper     = 'STAR/2.4.0j'
quantifier = 'RSEM/1.2.15'
samtools   = 'SAMtools/0.1.19'
decomp     = 'pigz/2.3.1'
rseqc      = 'RSeQC/2.3.9'
kentutils  = 'KentUtils/308'
pysam      = 'pysam/0.8.0'
bedtools   = 'BEDTools/2.19.1'
bamtools   = 'BamTools/2.3.1'

// Process configuration
process {

    beforeScript = 'module purge'

    executor = 'sge'
    queue    = 'rg-el6,long-sl65'
    penv = 'smp'

    errorStrategy = { params?.errorStrategy }
    
    tag = { if (view) id else species }

    $index {
        module = "${mapper}-${toolchain}"
        cpus = 4
        memory = '62G'
        time = '24h'
    }
    $t_index {
        module = "${quantifier}-${toolchain}"
        cpus = 4
        memory = '15G'
        time = '24h'
    }
    $mapping {
        module = "${samtools}-${toolchain}:${decomp}-${toolchain}:${mapper}-${toolchain}"
        cpus = 8
        memory = '62G'
        time = '48h'
    }
    $mergeBam {
        module = "${samtools}-${toolchain}"
        cpus = 8
        memory = '31G'
    }
    $inferExp {
        module = "${rseqc}-${toolchain}-${python}:${pysam}-${toolchain}-${python}:${kentutils}-${toolchain}"
    }
    $bigwig {
        module = "${samtools}-${toolchain}:${mapper}-${toolchain}:${kentutils}-${toolchain}"
        cpus = 4
        memory = '15G'
        time = '12h'
    }
    $contig {
        module = "${samtools}-${toolchain}:${bedtools}-${toolchain}:${bamtools}-${toolchain}:${kentutils}-${toolchain}"
        cpus = 4
        memory = '31G'
        time = '12h'
    }
    $quantification {
        module = "${quantifier}-${toolchain}"
        cpus = 8
        memory = '62G'
        time = '24h'
    }

}
